01:12:53 [Task2] read task description
01:14:49 [Task2] read source code
01:15:30 [Task2] read task description
01:17:38 [Task2] compile
01:17:51 [Task2] try input IDA
01:19:34 [Task2] try input I D A
01:19:50 [Task2] try input I | D
01:19:59 [Task2] try input I | DA
01:20:18 [Task2] read source code
01:22:24 [Task2] read task description
01:22:41 [Task2] scroll through source code
01:24:23 [Task2] copy source code
01:25:50 [Task2] code solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state()
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
    if state.addr in project.loader.extern_object.symbols_by_addr:
        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash)
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:27:13 [Task2] python3 -i solve.py
01:27:22 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state()
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash)
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:27:35 [Task2] python3 -i solve.py
01:27:49 [Task2] stop simulation
01:27:53 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state(add_options={angr.options.SYMBOL_FILLUNCONSTRAINED_MEMORY, angr.options=SYMBOL_FILL_UNCONSTRAINED_REGISTERS})
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash)
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:28:20 [Task2] python3 -i solve.py
01:28:48 [Task2] stop simulation
01:32:50 [Task2] try input I | EEEEEEEEEEEE
01:33:15 [Task2] try input I | EA
01:33:49 [Task2] sudo apt install strace
01:33:58 [Task2] strace ./main
01:34:18 [Task2] input I | EABCD
01:34:34 [Task2] scroll through source code
01:38:48 [Task2] load binary into ghidra
01:39:58 [Task2] scroll through disassembly code
01:40:12 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state(add_options={angr.options.SYMBOL_FILLUNCONSTRAINED_MEMORY, angr.options=SYMBOL_FILL_UNCONSTRAINED_REGISTERS})
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash, avoid=[0x401879,0x40161e,])
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:41:35 [Task2] read source code
01:41:56 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state(add_options={angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY, angr.options=SYMBOL_FILL_UNCONSTRAINED_REGISTERS})
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash, avoid=[0x401879,0x40161e, 0x4015af, 0x4015d4])
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:42:39 [Task2] python3 -i solve.py
01:43:26 [Task2] stop simulation
01:43:33 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state()
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash, avoid=[0x401879,0x40161e, 0x4015af, 0x4015d4])
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:43:47 [Task2] python3 -i solve.py
01:44:25 [Task2] stop simulation
01:48:58 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state(add_options={angr.options.STRICT_PAGE_ACCESS})
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash, avoid=[0x401879,0x40161e, 0x4015af, 0x4015d4])
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:49:20 [Task2] python3 -i solve.py
01:49:31 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state(add_options={angr.options.STRICT_PAGE_ACCESS, angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY, angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS})
def is_crash(state):
    if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash, avoid=[0x401879,0x40161e, 0x4015af, 0x4015d4])
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:49:53 [Task2] stop simulation
01:50:25 [Task2] python3 -i solve.py
01:51:54 [Task2] stop simulation
01:52:01 [Task2] edit source code
edit line 320: read(0, &c, 1);
01:52:28 [Task2] compile
01:53:30 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state(add_options={angr.options.STRICT_PAGE_ACCESS, angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY, angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS})
#def is_crash(state):
 #   if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
#        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
#    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=is_crash, avoid=[0x401879,0x40161e, 0x4015af, 0x4015d4])
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:53:56 [Task2] load binary into ghidra
01:54:32 [Task2] edit solve.py
import angr
import claripy
binary_path = './main'
project = angr.Project(binary_path, auto_load_libs=False)
state = project.factory.entry_state(add_options={angr.options.STRICT_PAGE_ACCESS, angr.options.SYMBOL_FILL_UNCONSTRAINED_MEMORY, angr.options.SYMBOL_FILL_UNCONSTRAINED_REGISTERS})
#def is_crash(state):
 #   if state.history.events and any(event.type == 'mem' and event.error for event in state.history.events:
#        return True
#    if state.addr in project.loader.extern_object.symbols_by_addr:
#        return True
#    return False
simgr = project.factory.simulation_manager(state)
simgr.explore(find=[0x401890], avoid=[0x40160b, 0x401895, 0x40159c, 0x4015c1])
if simgr.found:
    crash_state = simgr.found[0]
    print("Crash state found!")
    crash_state.stack_dump()
    print(crash_state.posix.dumps(0))
else:
    print("No crash state found.")
01:56:13 [Task2] python3 -i solve.py
01:58:43 [Task2] stop simulation
01:59:09 [Task2] fill survey
02:06:28 [Task2] python3
02:06:29 [Task2] > from pwn import *
02:06:31 [Task2] > p = process('./main')
02:06:38 [Task2] > input = b'D\nB\0\0\0\0\0\0\0\0D\nB\0\0\0\0\0\0\0\0'
02:06:47 [Task2] > p.send(input)
02:06:51 [Task2] > p.recv()
02:07:02 [Task2] stop simulation
02:07:21 [Task2] > input=b'DB\0\0\0\0\0\0\0\0DB\0\0\0\0\0\0\0\0'
02:07:24 [Task2] > p = process('./main')
02:07:29 [Task2] > p.send(input)
02:07:33 [Task2] > p.recv()
02:08:16 [Task2] fill survey
02:13:14 [Task2] > input=b'DBDB'
02:13:22 [Task2] > p=process('./main')
02:13:26 [Task2] > p.send(input)
02:13:29 [Task2] > p.recv()
02:13:41 [Task2] > p.send(b'DB')
02:13:47 [Task2] > p.recv()
02:14:07 [Task2] finish survey
